<%- model_class = Patient -%>
<% if @patient.errors.any? %>
<div class="alert">
	<h2><%= pluralize(@patient.errors.count, "error") %> prohibited this patient from being saved:</h2>
	<ul>
		<% @patient.errors.full_messages.each do |msg| %>
		<li><%= msg %></li>
		<% end %>
	</ul>
</div>
<% end %>
<div class="page-header">
	<h1>
		<span class="titlehighlight">
			<%= @patient.full_name.titleize %>
		</span>
		<span class="bluehighlight">
			<%= @patient.sex.titleize %>
		</span>
		<span class="titlehighlight">
			<%= @patient.age %>
		</span>
		<span class="bluehighlight">
			DOB:<%= @patient.date_of_birth %>
		</span>
	</h1>
	<h3>
		<%= "Phone: #{@patient.phone} Externalid: #{@patient.externalid}" %>
	</h3> 
</div>
<div class="row-fluid">
	<span class="span6">
		<h3>
			Contact Information <%= link_to 'Edit', @contact_info, class: "btn btn-small btn-info" %>
		</h3>
		<%= render partial: @contact_info %>
	</span>
	<span class="span6">
		<h3>
			Insurance Information <%= link_to 'Edit', @insurance_info, class: "btn btn-small btn-info" %>
		</h3>
		<%= render partial: @insurance_info %>
	</span>
</div>
<hr />
<div class="row-fluid">
	<span class="span12">
		<h3>Registration Information</h3>
		<div class="control-group">
			<% @patient.reg_answers.each do|ans| %>
			<p>
				<strong>Question: </strong><span class="control-label"><%= ans.reg_question_text.capitalize %></span><br />
				<strong>Answer:   </strong><span class="control-label"><%= ans.content  %></span>
			</p>
			<% end %>
		</div>
	</span>
</div>
<div class="row-fluid">
	<span class	="span12">
		<h3>Visit Information:</h3>		
		<div>
			<% @patient.visits.order("visit_date").each do|visit| %>
			<dl class="dl-horizontal">
				<dt>
					Visit Date:
				</dt>
				<dd>
					<%= visit.visit_date %>
				</dd>
				<dt>
					Visit Reason:
				</dt>
				<dd>
					<%= visit.visit_reason.capitalize %>
				</dd>
				<dt>
					Visit Note:
				</dt>
				<dd>
					<%= visit.visit_note %>
				</dd>
			</dl>
			<% if (visit.visit_date >= Date.today) %>
			<%= link_to 'Edit Visit', edit_visit_path(visit.id), :class => 'btn btn-small btn-info' %>
			<% end %>
			<hr />
			<% end %>
			<%= link_to 'Add Visit', new_visit_path(patient_id: @patient.id), class: "btn btn-small btn-primary" %>
		</div>
	</span>	
</div>
<div class="form-actions">
	<%= link_to t('.back', :default => t("helpers.links.back")),
	root_path, :class => 'btn'  %>
	<%= link_to 'Update Patient Profile',
	edit_patient_path(@patient), :class => 'btn btn-default btn-primary' %>
	<%#= link_to t('.destroy', :default => t("helpers.links.destroy")),
	patient_path(@patient),
	:method => 'delete',
	:data => { :confirm => t('.confirm', :default => t("helpers.links.confirm", :default => 'Are you sure?')) },
	:class => 'btn btn-danger' %>
</div>

<!-- <dl class="dl-horizontal">
<dt><strong><%= model_class.human_attribute_name(:date_of_birth) %>:</strong></dt>
<dd><%= @patient.date_of_birth %></dd>
</dl> -->