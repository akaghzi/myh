<%= form_for @visit, :html => { :class => 'form-horizontal' } do |f| %>
<% if @visit.errors.any? %>
<div class="alert">
	<h4><%= pluralize(@visit.errors.count, "error") %> prohibited this visit from being saved:</h4>
	<ul>
		<% @visit.errors.full_messages.each do |msg| %>
		<li><%= msg %></li>
		<% end %>
	</ul>
</div>
<% end %>

<div class="control-group">
	<%#= f.label :patient_id, :class => 'control-label' %>
	<div class="controls">
		<%= f.hidden_field :patient_id, :class => 'text_field' %>
	</div>
</div>
<!--  <div class="field">
<%= f.label :visit_date %><br />
<%= f.datetime_select :visit_date %>
</div>
-->
<div class="control-group">
	<%= f.label :visit_date, :class => 'control-label' %>
	<div class="controls">
	  <div class="input-append date datetimepicker">
			<%= f.text_field :visit_date, data: {:format => "yyyy-MM-dd hh:mm:ss"} %>
	    <span class="add-on"><i data-time-icon="icon-time" data-date-icon="icon-calendar"></i></span>
	  </div>
	</div>
</div>

<div class="control-group">
	<%= f.label :visit_reason, :class => 'control-label' %>
	<div class="controls">
		<%= f.text_field :visit_reason, :class => 'text_field' %>
	</div>
</div>
<!-- Add the test done in-house and order the tests that are outsourced here -->
<h4> Vital Signs:</h4>
<!-- Add vital signs here -->
<%= fields_for :vital_signs do | vvs | %>
<div class="control-group">
	<%= vvs.label :tempertaure, :class => 'control-label' %>
	<div class="controls">
		<%= vvs.number_field :temperature, class: "number_field" %>
	</div>
</div>
<div class="control-group">
	<%= vvs.label :heart_rate, :class => 'control-label' %>
	<div class="controls">
		<%= vvs.number_field :heart_rate, :class => 'number_field' %>
	</div>
</div>
<div class="control-group">
	<%= vvs.label :bp_systolic, :class => 'control-label' %>
	<div class="controls">
		<%= vvs.number_field :bp_systolic, :class => 'number_field' %>
	</div>
</div>
<div class="control-group">
	<%= vvs.label :bp_diastolic, :class => 'control-label' %>
	<div class="controls">
		<%= vvs.number_field :bp_diastolic, :class => 'number_field' %>
	</div>
</div>
<div class="control-group">
	<%= vvs.label :respiratory_rate, :class => 'control-label' %>
	<div class="controls">
		<%= vvs.number_field :respiratory_rate, :class => 'number_field' %>
	</div>
</div>
<div class="control-group">
	<%= vvs.label :weight, :class => 'control-label' %>
	<div class="controls">
		<%= vvs.number_field :weight, :class => 'number_field' %>
	</div>
</div>
<div class="control-group">
	<%= vvs.label :height, :class => 'control-label' %>
	<div class="controls">
		<%= vvs.number_field :height, :class => 'number_field' %>
	</div>
</div>
	
<% end %>

<!-- Vital Signs end here -->
<!-- Add out-sourced lab tests here -->
<div class="control-group">
	<h4>Laboratory tests ordered:</h4>
	<% for lab_test in LabTest.all do %>
	<div class="controls">
		<%= check_box_tag "visit[lab_test_ids][]", lab_test.id, @visit.lab_tests.include?(lab_test) , class: "check_box"%>
		<%= lab_test.short_name %>
	</div>
	<% end %>
</div>
<!-- Out sources lab tests end here -->
<div class="control-group">
	<%= f.label :visit_note, :class => 'control-label' %>
	<div class="controls">
		<%= f.text_area :visit_note, rows: 4, :class => 'input-xxlarge' %>
	</div>
</div>

<div class="form-actions">
	<%= f.submit nil, :class => 'btn btn-primary' %>
	<%= link_to t('.cancel', :default => t("helpers.links.cancel")),
	patient_path(id: @visit.patient.id), :class => 'btn' %>
</div>
<% end %>